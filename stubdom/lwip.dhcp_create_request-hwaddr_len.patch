---
 lwip-x86_64/src/core/dhcp.c |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

Index: src/core/dhcp.c
===================================================================
--- src/core/dhcp.c
+++ src/core/dhcp.c
@@ -1322,6 +1322,8 @@ dhcp_create_request(struct netif *netif)
 {
   struct dhcp *dhcp;
   u16_t i;
+  /* gcc can not know if hwaddr_len exceeds the hwaddr array size */
+  u8_t hwaddr_len = netif->hwaddr_len > NETIF_MAX_HWADDR_LEN ? NETIF_MAX_HWADDR_LEN : netif->hwaddr_len;
   LWIP_ERROR("dhcp_create_request: netif != NULL", (netif != NULL), return ERR_ARG;);
   dhcp = netif->dhcp;
   LWIP_ERROR("dhcp_create_request: dhcp != NULL", (dhcp != NULL), return ERR_VAL;);
@@ -1356,7 +1358,7 @@ dhcp_create_request(struct netif *netif)
   dhcp->msg_out->giaddr.addr = 0;
   for (i = 0; i < DHCP_CHADDR_LEN; i++) {
     /* copy netif hardware address, pad with zeroes */
-    dhcp->msg_out->chaddr[i] = (i < netif->hwaddr_len) ? netif->hwaddr[i] : 0/* pad byte*/;
+    dhcp->msg_out->chaddr[i] = (i < hwaddr_len) ? netif->hwaddr[i] : 0/* pad byte*/;
   }
   for (i = 0; i < DHCP_SNAME_LEN; i++) {
     dhcp->msg_out->sname[i] = 0;
